---
import { Color, Pattern, setStyles } from "@/scripts/interface";
import Icon, { type ICON_NAME } from "./Icon.astro";
import { titleCase } from "@/scripts/utilities";
import type { HTML } from "@/scripts/constants";

interface Props extends HTML {
	id?: string;
	type?: "submit" | "toggle" | "link";
	label?: string;
	href?: string;
	iconLeft?: boolean;
	icon?: ICON_NAME;
	disabled?: boolean;
	primary?: boolean;
	responsive?: boolean;
}

const {
	id,
	type = "link",
	label,
	href,
	icon = "arrow-right",
	primary,
	iconLeft,
	disabled,
	responsive,
	class: className,
} = Astro.props;
const buttonClasses = [
	"flex items-center justify-center gap-1 py-2 border-sm bg-[var(--button-color)] max-w-fit min-w-11 min-h-11 cursor-pointer",
	disabled ? "" : "button-marquee shadow-lg shadow-lg-hover",
	!label ? "px-2" : "px-4 max-sm:px-2",
];
const style = setStyles("button", setButtonColor(primary), Pattern["2"]);

function setButtonTitle(label: string | undefined): string {
	if (label) {
		return label;
	}
	return titleCase(icon);
}

function setButtonColor(isPrimary: boolean | undefined): string {
	if (isPrimary) {
		return Color.lime;
	}

	return Color.neutral;
}

function setIconSize(label: string | undefined): string {
	if (label) {
		return "16";
	}

	return "20";
}

function setIconColor(isDisabled: boolean | undefined): string {
	if (isDisabled) {
		return "var(--color-disabled-body)";
	}
	return "var(--color-text)";
}
---

{
	type === "submit" && (
		<button
			{id}
			data-disabled={disabled}
			{type}
			title={setButtonTitle(label)}
			class:list={[buttonClasses, className]}
			{style}
		>
			{label && (
				<strong class:list={["text-nowrap", responsive && "max-sm:hidden"]}>{label}</strong>
			)}
			{icon && <Icon name={icon} size={setIconSize(label)} color={setIconColor(disabled)} />}
		</button>
	)
}
{
	type === "toggle" && (
		<form action="toggle">
			<label
				{id}
				data-disabled={disabled}
				title={label ? label : titleCase(icon)}
				class:list={[buttonClasses, className]}
				{style}
			>
				<input type="checkbox" />
				{label && (
					<strong class:list={["text-nowrap", responsive && "max-sm:hidden"]}>
						{label}
					</strong>
				)}
				{icon && (
					<Icon name={icon} size={setIconSize(label)} color={setIconColor(disabled)} />
				)}
			</label>
		</form>
	)
}
{
	type === "link" && (
		<a
			{id}
			data-disabled={disabled}
			title={label ? label : titleCase(icon)}
			class:list={[buttonClasses, className]}
			{style}
			{href}
		>
			{iconLeft && (
				<Icon name={icon} size={setIconSize(label)} color={setIconColor(disabled)} />
			)}
			{label && (
				<strong class:list={["text-nowrap", responsive && "max-sm:hidden"]}>{label}</strong>
			)}
			{!iconLeft && icon !== "none" && (
				<Icon name={icon} size={setIconSize(label)} color={setIconColor(disabled)} />
			)}
		</a>
	)
}

<style>
	[data-disabled="true"] {
		color: var(--color-disabled-body);
		background: var(--color-disabled-bg);
		pointer-events: none;
		cursor: not-allowed;
	}

	label:has(input[type="checkbox"]) {
		& input[type="checkbox"] {
			display: none;
		}
	}

	label:has(input[type="checkbox"]:checked) {
		background-color: var(--color-lime);
		text-shadow: none;
	}
</style>
