---
import { calcReadTime } from "@/scripts/utilities";
import type { CollectionEntry } from "astro:content";

interface Props {
	content: CollectionEntry<"articles"> | CollectionEntry<"tools">;
}

const { content } = Astro.props;
---

<div class="flex flex-col gap-2">
	<span class="heading-xs">{calcReadTime(content.body)} min read</span>
	<span
		class="flex justify-start items-center bg-neutral-200 w-full h-2 rounded-full"
		style={{ "--prog-w": "40px" }}
	>
		<span
			data-article-progress
			class="bg-blue-600 rounded-full min-w-2 max-w-full h-2"
			onscroll="showScrollProgress()"></span>
	</span>
</div>

<script is:inline>
	const progressIndicator = document.querySelector("[data-article-progress]");

	window.onscroll = function () {
		const windowScroll = document.body.scrollTop || document.documentElement.scrollTop;
		const height =
			document.documentElement.scrollHeight - document.documentElement.clientHeight;
		const scrolled = (windowScroll / height) * 110;

		progressIndicator.style.width = scrolled + "%";
	};
</script>
