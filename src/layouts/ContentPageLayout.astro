---
import ContentNavigation from "@/components/ContentNavigation.astro";
import ImageWrapper from "@/components/ui/ImageWrapper.astro";
import Model from "@/components/ui/Model.astro";
import SideBar from "@/components/SideBar.astro";
import TagList from "@/components/TagList.astro";

import { calcReadTime, formatDate } from "@/scripts/utilities";
import type { Collection } from "@/content/config";

interface Props {
	content: Collection;
	contentCollection: Array<Collection>;
	index: number;
}

const { content, contentCollection, index } = Astro.props;
const { title, description, postDate, tags, image } = content.data;
const { collection, body } = content;
const { headings } = await content.render();
---

<div class="flex flex-col gap-16">
	{
		content.collection === "models" ? (
			<div class="flex flex-col gap-8">
				<ContentNavigation {content} {contentCollection} {index} />
				<Model {title} id={content.data.id} />
			</div>
		) : (
			<div class="relative flex flex-col gap-8">
				<ContentNavigation {content} {contentCollection} {index} />
				<ImageWrapper src={image} />
			</div>
		)
	}
	<div class="flex gap-16">
		<div class="flex flex-col gap-16">
			<div class="flex flex-col gap-4">
				<h1>{title}</h1>
				<TagList {tags} />
				<p>{description}</p>
				<small class="flex gap-2">
					{
						collection === "posts" && (
							<>
								<strong>{formatDate(postDate)}</strong>
								<span>&bullet;</span>
								<strong>{calcReadTime(body)} min read</strong>
							</>
						)
					}
					{
						collection === "tools" && (
							<>
								<strong>{formatDate(postDate)}</strong>
								<span>&bullet;</span>
								<strong>{content.data.version}</strong>
							</>
						)
					}
					{
						collection === "models" && (
							<>
								<strong>{formatDate(postDate)}</strong>
								<span>&bullet;</span>
								<strong>{content.data.size}</strong>
							</>
						)
					}
				</small>
			</div>
			<article class="content flex flex-col gap-8">
				<slot />
			</article>
		</div>
		<SideBar {headings} {content} />
	</div>
</div>
